<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Pontua√ß√£o de Vice-Presidentes</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="shortcut icon" href="favicon.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sql.js@1.8.0/dist/sql-wasm.js"></script>
    <style>
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        .sidebar {
            transition: all 0.3s ease;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -100%;
                top: 0;
                z-index: 50;
                height: 100vh;
            }
            .sidebar.active {
                left: 0;
            }
        }
        /* Estilo para o rodap√© fixo na parte inferior */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #1e3a8a; /* Cor de fundo similar √† sidebar */
            color: white;
            padding: 1rem;
            text-align: center;
            z-index: 40; /* Um z-index menor que a sidebar para n√£o cobri-la */
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <div class="flex flex-1"> <!-- flex-1 para que o conte√∫do principal e sidebar ocupem o espa√ßo restante -->
        <!-- Sidebar -->
        <div class="sidebar w-64 bg-blue-800 text-white p-4">
            <div class="flex items-center justify-between mb-8">
                <h1 class="text-2xl font-bold">Pontua√ß√£o de Vices</h1>
                <button id="closeSidebar" class="md:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <nav>
                <ul class="space-y-2">
                    <li>
                        <button id="dashboardBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                            </svg>
                            Dashboard
                        </button>
                    </li>
                    <li>
                        <button id="vpsBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            VPs
                        </button>
                    </li>
                    <li>
                        <button id="metasBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                            Metas
                        </button>
                    </li>
                    <li>
                        <button id="ipsBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            IPs
                        </button>
                    </li>
                    <li>
                        <button id="presidenciaBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15.75c-2.648 0-5.195-.429-7.645-1.295M12 10.5a3 3 0 11-6 0 3 3 0 016 0zm0 0v-4.5m0 4.5v4.5m0-4.5h4.5m-4.5 0H7.5m0 0a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Presid√™ncia
                        </button>
                    </li>
                    <li>
                        <button id="relatoriosBtn" class="w-full text-left px-4 py-2 rounded hover:bg-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                </svg>
                            Relat√≥rios
                        </button>
                    </li>
                </ul>
            </nav>
            <!-- O rodap√© foi movido para fora desta div -->
        </div>

        <!-- Conte√∫do principal -->
        <div class="flex-1 p-8 pb-16"> <!-- Adicionado padding-bottom para o rodap√© fixo -->
            <!-- Bot√£o mobile -->
            <button id="openSidebar" class="md:hidden mb-4 bg-blue-600 text-white p-2 rounded">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>

            <!-- Dashboard -->
            <div id="dashboardView" class="space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Dashboard de Desempenho</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Vice-Presidentes</p>
                                <h3 id="totalVPs" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Metas Registradas</p>
                                <h3 id="totalMetas" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="bg-green-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">M√©dia VP</p>
                                <h3 id="mediaPontuacao" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Melhor VP</p>
                                <h3 id="melhorVP" class="text-2xl font-bold">N/A</h3>
                                <p id="pontuacaoMelhorVP" class="text-sm text-gray-500">0 pontos</p>
                            </div>
                            <div class="bg-yellow-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Card Total de IPs -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Imagens P√∫blicas</p>
                                <h3 id="totalIPs" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="bg-blue-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Card M√©dia de Pontua√ß√£o de IPs -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">M√©dia IP</p>
                                <h3 id="mediaPontuacaoIP" class="text-3xl font-bold">0</h3>
                            </div>
                            <div class="bg-purple-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Card Melhor IP -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Melhor IP</p>
                                <h3 id="melhorIP" class="text-2xl font-bold">N/A</h3>
                                <p id="pontuacaoMelhorIP" class="text-sm text-gray-500">0 pontos</p>
                            </div>
                            <div class="bg-yellow-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>

                    <!-- Card de Metas da Presid√™ncia Conclu√≠das -->
                    <div class="bg-white rounded-lg shadow p-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <p class="text-gray-500">Metas Presid√™ncia</p>
                                <h3 id="percentMetasPresidencia" class="text-3xl font-bold">0%</h3>
                            </div>
                            <div class="bg-indigo-100 p-3 rounded-full">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Distribui√ß√£o de Pontua√ß√µes</h3>
                    <div class="chart-container">
                        <canvas id="scoreChart"></canvas>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Top 5 VPs</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="topVPsTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Posi√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Metas Alcan√ßadas</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Top 5 IPs</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="topIPsTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Clube</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Metas Alcan√ßadas</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gerenciamento de VPs -->
            <div id="vpsView" class="hidden space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Gerenciar Vice-Presidentes</h2>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Adicionar Novo VP</h3>
                    <form id="vpForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="vpNome" class="block text-sm font-medium text-gray-700">Nome Completo</label>
                            <input type="text" id="vpNome" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="vpPosicao" class="block text-sm font-medium text-gray-700">Posi√ß√£o</label>
                            <input type="text" id="vpPosicao" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div class="flex items-end">
                            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Adicionar VP
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Lista de Vice-Presidentes</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="vpsTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Posi√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gerenciamento de Metas -->
            <div id="metasView" class="hidden space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Gerenciar Metas</h2>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Adicionar Nova Meta</h3>
                    <form id="metaForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="metaNome" class="block text-sm font-medium text-gray-700">Descri√ß√£o da Meta</label>
                            <input type="text" id="metaNome" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="metaPeso" class="block text-sm font-medium text-gray-700">Peso/Pontua√ß√£o M√°xima</label>
                            <input type="number" id="metaPeso" min="1" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div class="md:col-span-2">
                            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Adicionar Meta
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Lista de Metas</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="metasTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Meta</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o M√°xima</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gerenciamento de IPs -->
            <div id="ipsView" class="hidden space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Gerenciar Imagens P√∫blicas</h2>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Adicionar Nova Imagem P√∫blica</h3>
                    <form id="ipForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="ipNome" class="block text-sm font-medium text-gray-700">Nome Completo</label>
                            <input type="text" id="ipNome" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="ipClube" class="block text-sm font-medium text-gray-700">Clube</label>
                            <input type="text" id="ipClube" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div class="flex items-end">
                            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Adicionar IP
                            </button>
                        </div>
                    </form>
                </div>

                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Lista de Imagens P√∫blicas</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="ipsTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Clube</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Dados ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Gerenciamento de Metas da Presid√™ncia e Projetos -->
            <div id="presidenciaView" class="hidden space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Gerenciar Presid√™ncia</h2>

                <!-- Metas da Presid√™ncia -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Metas da Presid√™ncia</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="presidenciaMetasTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Meta</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">√Årea</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Conclu√≠da</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Metas ser√£o preenchidas via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Registro de Projetos -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-xl font-semibold mb-4">Registro de Projetos</h3>
                    <form id="projetoForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="projetoNome" class="block text-sm font-medium text-gray-700">Nome do Projeto</label>
                            <input type="text" id="projetoNome" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="projetoDataInicio" class="block text-sm font-medium text-gray-700">Data de In√≠cio</label>
                            <input type="date" id="projetoDataInicio" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="projetoDataRealizacao" class="block text-sm font-medium text-gray-700">Data de Realiza√ß√£o</label>
                            <input type="date" id="projetoDataRealizacao" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">
                        </div>
                        <div>
                            <label for="projetoObjetivo" class="block text-sm font-medium text-gray-700">Objetivo</label>
                            <input type="text" id="projetoObjetivo" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        </div>
                        <div>
                            <label for="projetoBeneficiarios" class="block text-sm font-medium text-gray-700">Benefici√°rios</label>
                            <input type="text" id="projetoBeneficiarios" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">
                        </div>
                        <div>
                            <label for="projetoAreaEnfoque" class="block text-sm font-medium text-gray-700">√Årea de Enfoque</label>
                            <input type="text" id="projetoAreaEnfoque" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">
                        </div>
                        <div class="md:col-span-2">
                            <label for="projetoDificuldades" class="block text-sm font-medium text-gray-700">Dificuldades Enfrentadas</label>
                            <textarea id="projetoDificuldades" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"></textarea>
                        </div>
                        <div class="md:col-span-2">
                            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Registrar Projeto
                            </button>
                        </div>
                    </form>

                    <h3 class="text-xl font-semibold mb-4 mt-8">Projetos Registrados</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200" id="projetosTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data In√≠cio</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Objetivo</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Projetos ser√£o preenchidos via JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Relat√≥rios -->
            <div id="relatoriosView" class="hidden space-y-6">
                <h2 class="text-2xl font-bold text-gray-800">Relat√≥rios de Desempenho</h2>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-semibold">Selecione um VP para detalhar</h3>
                        <select id="vpSelectRelatorio" class="mt-1 block w-64 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border">
                            <option value="">Selecione um VP</option>
                            <!-- Op√ß√µes ser√£o preenchidas via JS -->
                        </select>
                    </div>

                    <div id="relatorioContainer" class="hidden">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div class="bg-white rounded-lg shadow p-4 border-t-4 border-blue-500">
                                <h4 class="font-medium text-gray-500">Nome</h4>
                                <p id="relatorioNome" class="text-xl font-semibold">-</p>
                            </div>
                            <div class="bg-white rounded-lg shadow p-4 border-t-4 border-green-500">
                                <h4 class="font-medium text-gray-500">Posi√ß√£o</h4>
                                <p id="relatorioPosicao" class="text-xl font-semibold">-</p>
                            </div>
                            <div class="bg-white rounded-lg shadow p-4 border-t-4 border-purple-500">
                                <h4 class="font-medium text-gray-500">Pontua√ß√£o Total</h4>
                                <p id="relatorioPontuacao" class="text-xl font-semibold">0</p>
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow p-6 mb-6">
                            <h3 class="text-xl font-semibold mb-4">Desempenho por Meta</h3>
                            <div class="chart-container">
                                <canvas id="vpChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-white rounded-lg shadow p-6">
                            <h3 class="text-xl font-semibold mb-4">Detalhes das Metas</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200" id="relatorioMetasTable">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Meta</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o M√°xima</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Pontua√ß√£o Obtida</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">% Conclu√≠do</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white divide-y divide-gray-200">
                                        <!-- Dados ser√£o preenchidos via JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Rodap√© global -->
    <footer class="footer">
        <p class="text-xs">Banco de dados interno SQLite</p>
    </footer>

    <!-- Modal para adicionar pontua√ß√£o (mantido) -->
    <div id="pontuacaoModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold" id="modalTitle">Adicionar Pontua√ß√£o</h3>
                    <button id="closePontuacaoModal" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <form id="pontuacaoForm">
                    <input type="hidden" id="targetIdPontuacao">
                    <input type="hidden" id="targetTypePontuacao">
                    <div class="mb-4">
                        <label for="metaSelect" class="block text-sm font-medium text-gray-700">Meta</label>
                        <select id="metaSelect" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                            <option value="">Selecione uma meta</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="pontuacaoValor" class="block text-sm font-medium text-gray-700">Pontua√ß√£o</label>
                        <input type="number" id="pontuacaoValor" min="0" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border" required>
                        <p class="mt-1 text-sm text-gray-500">Pontua√ß√£o m√°xima: <span id="pontuacaoMaxima">0</span></p>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" id="cancelPontuacao" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                            Cancelar
                        </button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700">
                            Salvar
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de confirma√ß√£o -->
    <div id="confirmModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-semibold" id="confirmModalTitle">Confirmar a√ß√£o</h3>
                    <button id="closeConfirmModal" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <p id="confirmModalMessage">Tem certeza que deseja continuar?</p>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button type="button" id="confirmCancel" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button type="button" id="confirmAction" class="px-4 py-2 bg-red-600 text-white rounded-md text-sm font-medium hover:bg-red-700">
                        Confirmar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let db;
        let SQL;
        let scoreChart;
        let vpChart;
        

        // Fun√ß√£o para salvar o banco de dados no localStorage
        function saveDB() {
            if (db) {
                const data = db.export();
                const b64 = btoa(String.fromCharCode.apply(null, data));
                localStorage.setItem('vpdb', b64);
            }
        }

        // Fun√ß√£o para carregar o banco de dados do localStorage
        function loadDBFromStorage(SQL) {
            const b64 = localStorage.getItem('vpdb');
            if (b64) {
                const binary = Uint8Array.from(atob(b64), c => c.charCodeAt(0));
                return new SQL.Database(binary);
            }
            return null;
        }

        // Inicializa√ß√£o do banco de dados
        async function initDB() {
            try {
                // Configurar o SQL.js para carregar o SQLite WASM
                SQL = await initSqlJs({
                    locateFile: file => `https://cdn.jsdelivr.net/npm/sql.js@1.8.0/dist/${file}`
                });

                // Tentar carregar do localStorage
                db = loadDBFromStorage(SQL);
                if (!db) {
                    // Criar novo banco de dados
                    db = new SQL.Database();

                    // Criar tabelas se n√£o existirem
                    db.run(`
                        CREATE TABLE IF NOT EXISTS vps (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            nome TEXT NOT NULL,
                            posicao TEXT NOT NULL,
                            data_criacao TEXT DEFAULT (datetime('now','localtime'))
                        );
                    `);

                    db.run(`
                        CREATE TABLE IF NOT EXISTS metas (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            descricao TEXT NOT NULL,
                            peso INTEGER NOT NULL,
                            data_criacao TEXT DEFAULT (datetime('now','localtime'))
                        );
                    `);

                    // Tabela de pontua√ß√µes agora referencia vp_id OU ip_id
                    db.run(`
                        CREATE TABLE IF NOT EXISTS pontuacoes (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            vp_id INTEGER,
                            ip_id INTEGER,
                            meta_id INTEGER NOT NULL,
                            pontuacao INTEGER NOT NULL,
                            data_registro TEXT DEFAULT (datetime('now','localtime')),
                            FOREIGN KEY(vp_id) REFERENCES vps(id),
                            FOREIGN KEY(ip_id) REFERENCES ips(id),
                            FOREIGN KEY(meta_id) REFERENCES metas(id),
                            CHECK ( (vp_id IS NOT NULL AND ip_id IS NULL) OR (vp_id IS NULL AND ip_id IS NOT NULL) )
                        );
                    `);

                    // Nova tabela para Imagens P√∫blicas (IPs) - Copia da estrutura de VPs
                    db.run(`
                        CREATE TABLE IF NOT EXISTS ips (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            nome TEXT NOT NULL,
                            clube TEXT NOT NULL,
                            data_criacao TEXT DEFAULT (datetime('now','localtime'))
                        );
                    `);

                    // Nova tabela para Metas da Presid√™ncia
                    db.run(`
                        CREATE TABLE IF NOT EXISTS presidencia_metas (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            descricao TEXT NOT NULL,
                            area TEXT NOT NULL,
                            concluida INTEGER DEFAULT 0, -- 0 para n√£o conclu√≠da, 1 para conclu√≠da
                            data_criacao TEXT DEFAULT (datetime('now','localtime'))
                        );
                    `);

                    // Nova tabela para Projetos
                    db.run(`
                        CREATE TABLE IF NOT EXISTS projetos (
                            id INTEGER PRIMARY KEY AUTOINCREMENT,
                            nome TEXT NOT NULL,
                            data_inicio TEXT NOT NULL,
                            data_realizacao TEXT,
                            objetivo TEXT NOT NULL,
                            beneficiarios TEXT,
                            area_enfoque TEXT,
                            dificuldades_enfrentadas TEXT,
                            data_registro TEXT DEFAULT (datetime('now','localtime'))
                        );
                    `);

                    // Adicionar alguns dados iniciais se as tabelas estiverem vazias
                    const vpsCount = db.exec("SELECT COUNT(*) as count FROM vps");
                    if (vpsCount[0]?.values[0][0] === 0) {
                        db.run("INSERT INTO vps (nome, posicao) VALUES (?, ?)", ["Jo√£o Silva", "VP de Opera√ß√µes"]);
                        db.run("INSERT INTO vps (nome, posicao) VALUES (?, ?)", ["Maria Souza", "VP de Tecnologia"]);
                        db.run("INSERT INTO vps (nome, posicao) VALUES (?, ?)", ["Carlos Oliveira", "VP de Marketing"]);
                    }

                    const metasCount = db.exec("SELECT COUNT(*) as count FROM metas");
                    if (metasCount[0]?.values[0][0] === 0) {
                        db.run("INSERT INTO metas (descricao, peso) VALUES (?, ?)", ["Aumentar receita em 20%", 100]);
                        db.run("INSERT INTO metas (descricao, peso) VALUES (?, ?)", ["Reduzir custos em 15%", 80]);
                        db.run("INSERT INTO metas (descricao, peso) VALUES (?, ?)", ["Lan√ßar 2 novos produtos", 120]);
                    }

                    // Adicionar metas da presid√™ncia iniciais
                    const presidenciaMetasCount = db.exec("SELECT COUNT(*) as count FROM presidencia_metas");
                    if (presidenciaMetasCount[0]?.values[0][0] === 0) {
                        const metasIniciais = [
                            { descricao: "Aumentar o quadro associativo em 30% l√≠quido.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Aumentar em 30% o n√∫mero de menores de 16 anos no clube.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Fundar 5 novos clubes no distrito.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Crescimento de pelo menos 30% no n√∫mero de associados do clube.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Ades√£o de 95% dos associados no censo final.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Ter 100% dos associados cadastrados no UnyClub.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Cada associado deve levar ao menos um amigo a uma reuni√£o durante a gest√£o.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Realizar 2 dias do convidado (um por semestre).", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Ter o aumento de no m√≠nimo 3 associados durante a gest√£o.", area: "üìà Crescimento do Clube e Quadro Associativo" },
                            { descricao: "Engajamento de 80% dos membros nas reuni√µes e eventos.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Misturar as 'panelinhas' nas reuni√µes/projetos.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Realizar 3 reuni√µes tem√°ticas no ano.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Realizar 1 projeto de integra√ß√£o interna por bimestre.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Brincadeiras em pelo menos uma reuni√£o mensal.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Din√¢micas sobre Rotary ao longo do ano (ex.: torta na cara).", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Acolhimento de convidados e entrosamento.", area: "üßë‚Äçü§ù‚Äçüßë Engajamento e Integra√ß√£o Interna" },
                            { descricao: "Alcan√ßar 70% dos clubes com a comenda Clube de Excel√™ncia.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Enviar 100% dos relat√≥rios mensais e atas.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Atualizar o regimento interno conforme o regimento distrital.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Criar Drive e arquivo f√≠sico para documentos.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Manter per capitas distritais em dia.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Adquirir produto da lojinha distrital por clube.", area: "üèÖ Excel√™ncia e Gest√£o" },
                            { descricao: "Aumentar seguidores nas redes sociais em pelo menos 30.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Realizar m√≠nimo 3 publica√ß√µes mensais.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "2 divulga√ß√µes em m√≠dias tradicionais.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Postar 80% das fotos das reuni√µes.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Postar 10 v√≠deos no TikTok.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Criar um site/blog do clube.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Melhorar a identidade visual.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Realizar ao menos 2 projetos do 'Modo Criativo'.", area: "üíª Imagem P√∫blica e Comunica√ß√£o" },
                            { descricao: "Realizar eventos beneficentes e rifas.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Fechar 3 parcerias com empresas.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Criar programa de apadrinhamento financeiro.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Doar R$2,00 por associado √† Funda√ß√£o Rot√°ria.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Aumentar o caixa em 15% l√≠quido.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Finalizar a gest√£o com caixa distrital acima de R$ 8.000,00.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Efetuar duas doa√ß√µes para entidades da comunidade.", area: "üí∞ Financeiro e Capta√ß√£o" },
                            { descricao: "Realizar ao menos 1 projeto com Rotary Padrinho.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Participar de 2 festivas do Rotary Padrinho.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Participar de 1 reuni√£o com o Rotary a cada 3 meses.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Fazer escala√ß√µes de rotarianos nas reuni√µes do Interact.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Realizar 1 projeto com cada clube da fam√≠lia rot√°ria local.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Firmar parceria com ao menos 10 empresas colaboradoras no distrito.", area: "ü´±üèª‚Äçü´≤üèΩ Parcerias e Fam√≠lia Rot√°ria" },
                            { descricao: "Realizar capacita√ß√µes e treinamentos internos.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Realizar 2 projetos de desenvolvimento de orat√≥ria.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Realizar 1 concurso interno de orat√≥ria.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Enviar 1 representante para o Concurso Distrital de Orat√≥ria.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Enviar v√≠deo trimestralmente com protocolo.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Ter protocolo com instru√ß√£o rot√°ria em reuni√µes.", area: "üß† Capacita√ß√£o, Protocolo e Desenvolvimento Pessoal" },
                            { descricao: "Realizar pelo menos 10 projetos sociais.", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Continuar e ampliar projeto no Lar dos Idosos.", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Fazer projetos de refor√ßo escolar e leitura.", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar projetos sustent√°veis (hortas, reciclagem).", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 3 projetos de arrecada√ß√£o/doa√ß√µes;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 2 projetos com campanha mensal;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 2 projetos em datas comemorativas;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 1 projeto de leitura;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 1 projeto com outro clube do distrito;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 2 projetos com DQA;", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "Realizar ao menos: 2 propostas do 4x4/Modo Criativo.", area: "‚ù§Ô∏è Projetos Sociais e Sustent√°veis" },
                            { descricao: "2 projetos de meio ambiente;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "1 de preven√ß√£o de doen√ßas;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "1 de √°gua, saneamento e higiene;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "1 materno-infantil;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "2 ou 3 de educa√ß√£o b√°sica e alfabetiza√ß√£o;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "(opcional) 1 de desenvolvimento econ√¥mico comunit√°rio;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "(opcional) 1 de consolida√ß√£o da paz;", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "2 projetos por avenida de servi√ßo ao longo da gest√£o.", area: "üåç √Åreas de Enfoque Rot√°rio" },
                            { descricao: "Cumprir com todos os eventos distritais: CEDIC, CODIC, SEODIC, EDAICs", area: "üìÖ Eventos e Participa√ß√µes" },
                            { descricao: "Realizar o Concurso Distrital de Orat√≥ria com 90% de clubes presentes.", area: "üìÖ Eventos e Participa√ß√µes" },
                            { descricao: "Participar do PRODIB com pelo menos 80% de conclus√£o.", area: "üìÖ Eventos e Participa√ß√µes" },
                            { descricao: "Divulgar o clube ao menos 1 vez em escola.", area: "üìÖ Eventos e Participa√ß√µes" },
                            { descricao: "Realizar 1 projeto com a √°rea.", area: "üìÖ Eventos e Participa√ß√µes" }
                        ];
                        metasIniciais.forEach(meta => {
                            db.run("INSERT INTO presidencia_metas (descricao, area) VALUES (?, ?)", [meta.descricao, meta.area]);
                        });
                    }

                    // Salvar banco inicial
                    saveDB();
                }

                // Carregar dados iniciais
                loadDashboardData();
                loadVPsData();
                loadMetasData();
                loadIPsData(); // Carregar dados de IPs
                loadPresidenciaMetasData(); // Carregar metas da presid√™ncia
                loadProjetosData(); // Carregar projetos
                loadVPsForSelect(); // Manter para relat√≥rios de VPs
                console.log("Banco de dados inicializado com sucesso!");
            } catch (error) {
                console.error("Erro ao inicializar o banco de dados:", error);
            }
        }
        
        // Fun√ß√µes para carregar dados
        function loadDashboardData() {
            // Total de VPs
            const totalVPs = db.exec("SELECT COUNT(*) FROM vps");
            document.getElementById('totalVPs').textContent = totalVPs[0]?.values[0][0] || 0;
            
            // Total de Metas
            const totalMetas = db.exec("SELECT COUNT(*) FROM metas");
            document.getElementById('totalMetas').textContent = totalMetas[0]?.values[0][0] || 0;
            
            // M√©dia de pontua√ß√£o dos VPs
            const mediaPontuacao = db.exec(`
                SELECT AVG(total) as media 
                FROM (
                    SELECT v.id, SUM(p.pontuacao) as total 
                    FROM vps v 
                    LEFT JOIN pontuacoes p ON v.id = p.vp_id 
                    GROUP BY v.id
                )
            `);
            const media = mediaPontuacao[0]?.values[0]?.[0] || 0;
            document.getElementById('mediaPontuacao').textContent = media.toFixed(1);
            
            // Melhor VP
            const melhorVP = db.exec(`
                SELECT v.nome, SUM(p.pontuacao) as total 
                FROM vps v 
                LEFT JOIN pontuacoes p ON v.id = p.vp_id 
                GROUP BY v.id 
                ORDER BY total DESC 
                LIMIT 1
            `);
            
            if (melhorVP[0]?.values[0]) {
                document.getElementById('melhorVP').textContent = melhorVP[0].values[0][0];
                document.getElementById('pontuacaoMelhorVP').textContent = `${melhorVP[0].values[0][1] || 0} pontos`;
            } else {
                document.getElementById('melhorVP').textContent = "N/A";
                document.getElementById('pontuacaoMelhorVP').textContent = "0 pontos";
            }
            
            // Top 5 VPs
            const topVPs = db.exec(`
                SELECT v.nome, v.posicao, SUM(p.pontuacao) as total, 
                       (SELECT COUNT(*) FROM pontuacoes WHERE vp_id = v.id) as metas_atingidas
                FROM vps v 
                LEFT JOIN pontuacoes p ON v.id = p.vp_id 
                GROUP BY v.id 
                ORDER BY total DESC 
                LIMIT 5
            `);
            
            const topVPsTable = document.querySelector('#topVPsTable tbody');
            topVPsTable.innerHTML = '';
            
            if (topVPs[0]?.values) {
                let posicao = 1;
                topVPs[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[0]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${posicao++}¬∫</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2] || 0}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[3] || 0}</td>
                    `;
                    topVPsTable.appendChild(tr);
                });
            }

            // Total de IPs
            const totalIPs = db.exec("SELECT COUNT(*) FROM ips");
            document.getElementById('totalIPs').textContent = totalIPs[0]?.values[0][0] || 0;

            // M√©dia de pontua√ß√£o dos IPs
            const mediaPontuacaoIP = db.exec(`
                SELECT AVG(total) as media 
                FROM (
                    SELECT i.id, SUM(p.pontuacao) as total 
                    FROM ips i 
                    LEFT JOIN pontuacoes p ON i.id = p.ip_id 
                    GROUP BY i.id
                )
            `);
            const mediaIP = mediaPontuacaoIP[0]?.values[0]?.[0] || 0;
            document.getElementById('mediaPontuacaoIP').textContent = mediaIP.toFixed(1);

            // Melhor IP
            const melhorIP = db.exec(`
                SELECT i.nome, SUM(p.pontuacao) as total 
                FROM ips i 
                LEFT JOIN pontuacoes p ON i.id = p.ip_id 
                GROUP BY i.id 
                ORDER BY total DESC 
                LIMIT 1
            `);
            
            if (melhorIP[0]?.values[0]) {
                document.getElementById('melhorIP').textContent = melhorIP[0].values[0][0];
                document.getElementById('pontuacaoMelhorIP').textContent = `${melhorIP[0].values[0][1] || 0} pontos`;
            } else {
                document.getElementById('melhorIP').textContent = "N/A";
                document.getElementById('pontuacaoMelhorIP').textContent = "0 pontos";
            }

            // Top 5 IPs
            const topIPs = db.exec(`
                SELECT i.nome, i.clube, SUM(p.pontuacao) as total, 
                       (SELECT COUNT(*) FROM pontuacoes WHERE ip_id = i.id) as metas_atingidas
                FROM ips i 
                LEFT JOIN pontuacoes p ON i.id = p.ip_id 
                GROUP BY i.id 
                ORDER BY total DESC 
                LIMIT 5
            `);
            
            const topIPsTable = document.querySelector('#topIPsTable tbody');
            topIPsTable.innerHTML = '';
            
            if (topIPs[0]?.values) {
                topIPs[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[0]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2] || 0}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[3] || 0}</td>
                    `;
                    topIPsTable.appendChild(tr);
                });
            }

            // Porcentagem de Metas da Presid√™ncia Conclu√≠das
            const totalPresidenciaMetas = db.exec("SELECT COUNT(*) FROM presidencia_metas");
            const metasConcluidas = db.exec("SELECT COUNT(*) FROM presidencia_metas WHERE concluida = 1");
            
            const total = totalPresidenciaMetas[0]?.values[0][0] || 0;
            const concluidas = metasConcluidas[0]?.values[0][0] || 0;
            
            let percentual = 0;
            if (total > 0) {
                percentual = (concluidas / total) * 100;
            }
            document.getElementById('percentMetasPresidencia').textContent = `${percentual.toFixed(0)}%`;
            
            // Gr√°fico de distribui√ß√£o de pontua√ß√µes
            renderScoreChart();
        }
        
        function loadVPsData() {
            const vps = db.exec(`
                SELECT v.*, 
                       (SELECT SUM(pontuacao) FROM pontuacoes WHERE vp_id = v.id) as total_pontos
                FROM vps v
                ORDER BY v.nome
            `);
            
            const vpsTable = document.querySelector('#vpsTable tbody');
            vpsTable.innerHTML = '';
            
            if (vps[0]?.values) {
                vps[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[4] || 0}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <button class="text-blue-600 hover:text-blue-800 mr-3" onclick="openPontuacaoModal('vp', ${row[0]})">
                                Pontuar
                            </button>
                            <button class="text-red-600 hover:text-red-800" onclick="confirmDelete('vp', ${row[0]}, '${row[1]}')">
                                Remover
                            </button>
                        </td>
                    `;
                    vpsTable.appendChild(tr);
                });
            }
        }
        
        function loadMetasData() {
            const metas = db.exec("SELECT * FROM metas ORDER BY descricao");
            
            const metasTable = document.querySelector('#metasTable tbody');
            metasTable.innerHTML = '';
            
            if (metas[0]?.values) {
                metas[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <button class="text-red-600 hover:text-red-800" onclick="confirmDelete('meta', ${row[0]}, '${row[1]}')">
                                Remover
                            </button>
                        </td>
                    `;
                    metasTable.appendChild(tr);
                });
            }
        }

        // Fun√ß√£o para carregar dados de IPs (copia de loadVPsData)
        function loadIPsData() {
            const ips = db.exec(`
                SELECT i.*, 
                       (SELECT SUM(pontuacao) FROM pontuacoes WHERE ip_id = i.id) as total_pontos
                FROM ips i
                ORDER BY i.nome
            `);
            
            const ipsTable = document.querySelector('#ipsTable tbody');
            ipsTable.innerHTML = '';
            
            if (ips[0]?.values) {
                ips[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[4] || 0}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <button class="text-blue-600 hover:text-blue-800 mr-3" onclick="openPontuacaoModal('ip', ${row[0]})">
                                Pontuar
                            </button>
                            <button class="text-red-600 hover:text-red-800" onclick="confirmDelete('ip', ${row[0]}, '${row[1]}')">
                                Remover
                            </button>
                        </td>
                    `;
                    ipsTable.appendChild(tr);
                });
            }
        }

        // Fun√ß√£o para carregar metas da presid√™ncia
        function loadPresidenciaMetasData() {
            const metas = db.exec("SELECT * FROM presidencia_metas ORDER BY area, descricao");
            
            const metasTable = document.querySelector('#presidenciaMetasTable tbody');
            metasTable.innerHTML = '';
            
            if (metas[0]?.values) {
                metas[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    const isChecked = row[3] === 1 ? 'checked' : '';
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600" data-id="${row[0]}" ${isChecked} onchange="togglePresidenciaMeta(${row[0]}, this.checked)">
                        </td>
                    `;
                    metasTable.appendChild(tr);
                });
            }
        }

        // Fun√ß√£o para carregar projetos
        function loadProjetosData() {
            const projetos = db.exec("SELECT * FROM projetos ORDER BY data_inicio DESC");
            
            const projetosTable = document.querySelector('#projetosTable tbody');
            projetosTable.innerHTML = '';
            
            if (projetos[0]?.values) {
                projetos[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[4]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <button class="text-yellow-600 hover:text-yellow-800 mr-3" onclick="editProjeto(${row[0]}, '${row[1]}', '${row[2]}', '${row[3] || ''}', '${row[4]}', '${row[5] || ''}', '${row[6] || ''}', '${row[7] || ''}')">
                                Editar
                            </button>
                            <button class="text-red-600 hover:text-red-800" onclick="confirmDelete('projeto', ${row[0]}, '${row[1]}')">
                                Remover
                            </button>
                        </td>
                    `;
                    projetosTable.appendChild(tr);
                });
            }
        }
        
        function loadVPsForSelect() {
            const vps = db.exec("SELECT id, nome FROM vps ORDER BY nome");
            const select = document.getElementById('vpSelectRelatorio');
            select.innerHTML = '<option value="">Selecione um VP</option>';
            
            if (vps[0]?.values) {
                vps[0].values.forEach(row => {
                    const option = document.createElement('option');
                    option.value = row[0];
                    option.textContent = row[1];
                    select.appendChild(option);
                });
            }
        }
        
        // openPontuacaoModal agora aceita o tipo (vp ou ip) e o ID
        function openPontuacaoModal(type, id) {
            loadMetasForPontuacao(); // Metas s√£o as mesmas para ambos
            
            let name = '';
            if (type === 'vp') {
                const vpInfo = db.exec("SELECT nome FROM vps WHERE id = ?", [id]);
                name = vpInfo[0]?.values?.[0]?.[0] || '';
            } else if (type === 'ip') {
                const ipInfo = db.exec("SELECT nome FROM ips WHERE id = ?", [id]);
                name = ipInfo[0]?.values?.[0]?.[0] || '';
            }

            document.getElementById('modalTitle').textContent = `Pontuar ${name}`;
            document.getElementById('targetIdPontuacao').value = id;
            document.getElementById('targetTypePontuacao').value = type; // Salva o tipo
            document.getElementById('pontuacaoModal').classList.remove('hidden');
        }

        // loadMetasForPontuacao n√£o precisa mais do vpId, pois √© gen√©rico
        function loadMetasForPontuacao() {
            const metas = db.exec("SELECT id, descricao, peso FROM metas ORDER BY descricao");
            const select = document.getElementById('metaSelect');
            select.innerHTML = '<option value="">Selecione uma meta</option>';
            
            if (metas[0]?.values) {
                metas[0].values.forEach(row => {
                    const option = document.createElement('option');
                    option.value = row[0];
                    option.dataset.max = row[2];
                    option.textContent = `${row[1]} (${row[2]} pts)`;
                    select.appendChild(option);
                });
            }
        }
        
        // Fun√ß√µes para manipula√ß√£o de dados

        function addVP(nome, posicao) {
            try {
                db.run("INSERT INTO vps (nome, posicao) VALUES (?, ?)", [nome, posicao]);
                saveDB();
                loadDashboardData();
                loadVPsData();
                loadVPsForSelect();
                return true;
            } catch (error) {
                console.error("Erro ao adicionar VP:", error);
                return false;
            }
        }
        

        function addMeta(descricao, peso) {
            try {
                db.run("INSERT INTO metas (descricao, peso) VALUES (?, ?)", [descricao, peso]);
                saveDB();
                loadDashboardData();
                loadMetasData();
                return true;
            } catch (error) {
                console.error("Erro ao adicionar meta:", error);
                return false;
            }
        }

        // Fun√ß√£o para adicionar IP (copia de addVP)
        function addIP(nome, clube) {
            try {
                db.run("INSERT INTO ips (nome, clube) VALUES (?, ?)", [nome, clube]);
                saveDB();
                loadIPsData(); // Recarrega os dados da tabela de IPs
                loadDashboardData(); // Atualiza o dashboard com o novo IP
                return true;
            } catch (error) {
                console.error("Erro ao adicionar IP:", error);
                return false;
            }
        }
        
        // addPontuacao agora lida com vp_id ou ip_id
        function addPontuacao(targetType, targetId, metaId, pontuacao) {
            try {
                let queryCheck, queryUpdate, queryInsert;
                let paramsCheck, paramsUpdate, paramsInsert;

                if (targetType === 'vp') {
                    queryCheck = "SELECT id FROM pontuacoes WHERE vp_id = ? AND meta_id = ?";
                    queryUpdate = "UPDATE pontuacoes SET pontuacao = ? WHERE id = ?";
                    queryInsert = "INSERT INTO pontuacoes (vp_id, meta_id, pontuacao) VALUES (?, ?, ?)";
                    paramsCheck = [targetId, metaId];
                } else if (targetType === 'ip') {
                    queryCheck = "SELECT id FROM pontuacoes WHERE ip_id = ? AND meta_id = ?";
                    queryUpdate = "UPDATE pontuacoes SET pontuacao = ? WHERE id = ?";
                    queryInsert = "INSERT INTO pontuacoes (ip_id, meta_id, pontuacao) VALUES (?, ?, ?)";
                    paramsCheck = [targetId, metaId];
                } else {
                    console.error("Tipo de alvo inv√°lido para pontua√ß√£o:", targetType);
                    return false;
                }

                const existe = db.exec(queryCheck, paramsCheck);

                if (existe[0]?.values?.length > 0) {
                    // Atualizar pontua√ß√£o existente
                    paramsUpdate = [pontuacao, existe[0].values[0][0]];
                    db.run(queryUpdate, paramsUpdate);
                } else {
                    // Inserir nova pontua√ß√£o
                    paramsInsert = (targetType === 'vp') ? [targetId, metaId, pontuacao] : [targetId, metaId, pontuacao];
                    db.run(queryInsert, paramsInsert);
                }

                saveDB();
                loadDashboardData();
                loadVPsData();
                loadIPsData(); // Recarrega dados de IPs tamb√©m
                updateRelatorio(); // Se o relat√≥rio for para VPs, ele ser√° atualizado. Se for para IPs, precisaria de uma fun√ß√£o similar.
                return true;
            } catch (error) {
                console.error("Erro ao adicionar pontua√ß√£o:", error);
                return false;
            }
        }

        // Fun√ß√µes para Metas da Presid√™ncia
        // Removidas addPresidenciaMeta e updatePresidenciaMeta, pois as metas s√£o fixas.

        function togglePresidenciaMeta(id, concluida) {
            try {
                const status = concluida ? 1 : 0;
                db.run("UPDATE presidencia_metas SET concluida = ? WHERE id = ?", [status, id]);
                saveDB();
                loadDashboardData(); // Atualiza o dashboard para refletir a mudan√ßa
                return true;
            } catch (error) {
                console.error("Erro ao alternar status da meta da presid√™ncia:", error);
                return false;
            }
        }

        // Fun√ß√µes para Projetos
        function addProjeto(nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades) {
            try {
                db.run("INSERT INTO projetos (nome, data_inicio, data_realizacao, objetivo, beneficiarios, area_enfoque, dificuldades_enfrentadas) VALUES (?, ?, ?, ?, ?, ?, ?)", 
                    [nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades]);
                saveDB();
                loadProjetosData();
                return true;
            } catch (error) {
                console.error("Erro ao adicionar projeto:", error);
                return false;
            }
        }

        function updateProjeto(id, nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades) {
            try {
                db.run("UPDATE projetos SET nome = ?, data_inicio = ?, data_realizacao = ?, objetivo = ?, beneficiarios = ?, area_enfoque = ?, dificuldades_enfrentadas = ? WHERE id = ?", 
                    [nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades, id]);
                saveDB();
                loadProjetosData();
                return true;
            } catch (error) {
                console.error("Erro ao atualizar projeto:", error);
                return false;
            }
        }
        

        function deleteRecord(tipo, id) {
            try {
                if (tipo === 'vp') {
                    // Primeiro deletar pontua√ß√µes relacionadas
                    db.run("DELETE FROM pontuacoes WHERE vp_id = ?", [id]);
                    // Depois deletar o VP
                    db.run("DELETE FROM vps WHERE id = ?", [id]);
                } else if (tipo === 'meta') {
                    // Primeiro deletar pontua√ß√µes relacionadas
                    db.run("DELETE FROM pontuacoes WHERE meta_id = ?", [id]);
                    // Depois deletar a meta
                    db.run("DELETE FROM metas WHERE id = ?", [id]);
                } else if (tipo === 'ip') { // Adicionado para IPs
                    // Primeiro deletar pontua√ß√µes relacionadas
                    db.run("DELETE FROM pontuacoes WHERE ip_id = ?", [id]);
                    // Depois deletar o IP
                    db.run("DELETE FROM ips WHERE id = ?", [id]);
                } else if (tipo === 'presidencia_meta') { // Adicionado para metas da presid√™ncia
                    // N√£o permitimos exclus√£o de metas da presid√™ncia fixas
                    console.warn("Exclus√£o de metas da presid√™ncia n√£o permitida.");
                    return false;
                } else if (tipo === 'projeto') { // Adicionado para projetos
                    db.run("DELETE FROM projetos WHERE id = ?", [id]);
                }

                saveDB();
                loadDashboardData();
                loadVPsData();
                loadMetasData();
                loadIPsData(); // Recarrega os dados de IPs ap√≥s a exclus√£o
                loadPresidenciaMetasData(); // Recarrega metas da presid√™ncia
                loadProjetosData(); // Recarrega projetos
                loadVPsForSelect();
                updateRelatorio();
                return true;
            } catch (error) {
                console.error(`Erro ao deletar ${tipo}:`, error);

                return false;
            }
        }
        
        // Fun√ß√µes para renderiza√ß√£o de gr√°ficos
        function renderScoreChart() {
            // Obter dados para o gr√°fico (considerando VPs e IPs)
            const vpScores = db.exec(`
                SELECT SUM(p.pontuacao) as total
                FROM vps v 
                LEFT JOIN pontuacoes p ON v.id = p.vp_id 
                GROUP BY v.id
            `);
            const ipScores = db.exec(`
                SELECT SUM(p.pontuacao) as total
                FROM ips i 
                LEFT JOIN pontuacoes p ON i.id = p.ip_id 
                GROUP BY i.id
            `);

            const pontuacoes = [
                ...(vpScores[0]?.values.map(row => row[0] || 0) || []),
                ...(ipScores[0]?.values.map(row => row[0] || 0) || [])
            ];
            
            // Agrupar pontua√ß√µes em intervalos para o histograma
            const intervalos = {};
            pontuacoes.forEach(p => {
                const intervalo = Math.floor(p / 50) * 50;
                intervalos[intervalo] = (intervalos[intervalo] || 0) + 1;
            });
            
            const labels = Object.keys(intervalos).sort((a, b) => a - b).map(k => `${k}-${Number(k)+49}`);
            const data = Object.keys(intervalos).sort((a, b) => a - b).map(k => intervalos[k]);
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (scoreChart) {
                scoreChart.destroy();
            }
            
            const ctx = document.getElementById('scoreChart').getContext('2d');
            scoreChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'N√∫mero de Entidades (VPs/IPs)',
                        data: data,
                        backgroundColor: 'rgba(59, 130, 246, 0.5)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'N√∫mero de Entidades'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Intervalo de Pontua√ß√£o'
                            }
                        }
                    }
                }
            });
        }
        
        function renderVPChart(vpId) {
            // Obter dados para o gr√°fico
            const dados = db.exec(`
                SELECT m.descricao, m.peso, p.pontuacao 
                FROM metas m 
                LEFT JOIN pontuacoes p ON m.id = p.meta_id AND p.vp_id = ?
                ORDER BY m.descricao
            `, [vpId]);
            
            if (!dados[0]?.values) return;
            
            const labels = dados[0].values.map(row => row[0]);
            const pesos = dados[0].values.map(row => row[1]);
            const pontuacoes = dados[0].values.map(row => row[2] || 0);
            
            // Se j√° existe um gr√°fico, destru√≠-lo
            if (vpChart) {
                vpChart.destroy();
            }
            
            const ctx = document.getElementById('vpChart').getContext('2d');
            vpChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Pontua√ß√£o M√°xima',
                            data: pesos,
                            backgroundColor: 'rgba(156, 163, 175, 0.5)',
                            borderColor: 'rgba(156, 163, 175, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Pontua√ß√£o Obtida',
                            data: pontuacoes,
                            backgroundColor: 'rgba(59, 130, 246, 0.5)',
                            borderColor: 'rgba(59, 130, 246, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Pontua√ß√£o'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Metas'
                            }
                        }
                    }
                }
            });
        }
        
        // Fun√ß√µes para manipula√ß√£o da UI
        // openPontuacaoModal agora √© chamada com o tipo e o ID
        // function openPontuacaoModal(type, id) { ... } (j√° definida acima)
        
        function confirmDelete(tipo, id, nome) {
            document.getElementById('confirmModal').classList.remove('hidden');
            document.getElementById('confirmModalTitle').textContent = `Confirmar Remo√ß√£o`;
            let message = '';
            if (tipo === 'vp') {
                message = `Tem certeza que deseja remover o VP "${nome}"? Todas as pontua√ß√µes associadas tamb√©m ser√£o removidas.`;
            } else if (tipo === 'meta') {
                message = `Tem certeza que deseja remover a meta "${nome}"? Todas as pontua√ß√µes associadas a esta meta tamb√©m ser√£o removidas.`;
            } else if (tipo === 'ip') {
                message = `Tem certeza que deseja remover a Imagem P√∫blica "${nome}"? Todas as pontua√ß√µes associadas tamb√©m ser√£o removidas.`;
            } else if (tipo === 'presidencia_meta') {
                message = `Tem certeza que deseja remover a meta da presid√™ncia "${nome}"? Esta a√ß√£o n√£o pode ser desfeita.`;
            } else if (tipo === 'projeto') {
                message = `Tem certeza que deseja remover o projeto "${nome}"? Esta a√ß√£o n√£o pode ser desfeita.`;
            }
            document.getElementById('confirmModalMessage').textContent = message;
            
            document.getElementById('confirmAction').onclick = function() {
                deleteRecord(tipo, id);
                document.getElementById('confirmModal').classList.add('hidden');
            };
        }

        // openPresidenciaMetaModal e fun√ß√µes relacionadas √† edi√ß√£o/adi√ß√£o de metas da presid√™ncia foram removidas.

        function editProjeto(id, nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades) {
            document.getElementById('projetoForm').reset(); // Limpa o formul√°rio primeiro
            document.getElementById('projetoForm').dataset.editId = id; // Armazena o ID para edi√ß√£o

            document.getElementById('projetoNome').value = nome;
            document.getElementById('projetoDataInicio').value = dataInicio;
            document.getElementById('projetoDataRealizacao').value = dataRealizacao;
            document.getElementById('projetoObjetivo').value = objetivo;
            document.getElementById('projetoBeneficiarios').value = beneficiarios;
            document.getElementById('projetoAreaEnfoque').value = areaEnfoque;
            document.getElementById('projetoDificuldades').value = dificuldades;

            // Altera o texto do bot√£o para "Atualizar Projeto"
            document.querySelector('#projetoForm button[type="submit"]').textContent = 'Atualizar Projeto';
        }
        
        function updateRelatorio() {
            const vpId = document.getElementById('vpSelectRelatorio').value;
            if (!vpId) {
                document.getElementById('relatorioContainer').classList.add('hidden');
                return;
            }
            
            document.getElementById('relatorioContainer').classList.remove('hidden');
            
            // Informa√ß√µes b√°sicas do VP
            const vpInfo = db.exec(`
                SELECT v.nome, v.posicao, SUM(p.pontuacao) as total 
                FROM vps v 
                LEFT JOIN pontuacoes p ON v.id = p.vp_id 
                WHERE v.id = ?
                GROUP BY v.id
            `, [vpId]);
            
            if (vpInfo[0]?.values?.[0]) {
                document.getElementById('relatorioNome').textContent = vpInfo[0].values[0][0];
                document.getElementById('relatorioPosicao').textContent = vpInfo[0].values[0][1];
                document.getElementById('relatorioPontuacao').textContent = vpInfo[0].values[0][2] || 0;
            }
            
            // Gr√°fico de desempenho
            renderVPChart(vpId);
            
            // Tabela de metas
            const metasVP = db.exec(`
                SELECT m.descricao, m.peso, p.pontuacao 
                FROM metas m 
                LEFT JOIN pontuacoes p ON m.id = p.meta_id AND p.vp_id = ?
                ORDER BY m.descricao
            `, [vpId]);
            
            const table = document.querySelector('#relatorioMetasTable tbody');
            table.innerHTML = '';
            
            if (metasVP[0]?.values) {
                metasVP[0].values.forEach(row => {
                    const tr = document.createElement('tr');
                    const percentual = row[1] > 0 ? Math.round((row[2] || 0) / row[1] * 100) : 0; // Corrigido para usar peso (row[1])
                    
                    tr.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${row[0]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[1]}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${row[2] || 0}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-full bg-gray-200 rounded-full h-2.5 mr-2">
                                    <div class="bg-blue-600 h-2.5 rounded-full" style="width: ${percentual}%"></div>
                                </div>
                                <span>${percentual}%</span>
                            </div>
                        </td>
                    `;
                    table.appendChild(tr);
                });
            }
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initDB();
            
            // Navega√ß√£o
            document.querySelectorAll('#dashboardBtn, #vpsBtn, #metasBtn, #ipsBtn, #presidenciaBtn, #relatoriosBtn').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('#dashboardView, #vpsView, #metasView, #relatoriosView, #ipsView, #presidenciaView').forEach(view => {
                        view.classList.add('hidden');
                    });
                    const viewId = this.id.replace('Btn', 'View');
                    document.getElementById(viewId).classList.remove('hidden');

                    // Recarregar dados espec√≠ficos da aba
                    if (viewId === 'vpsView') loadVPsData();
                    if (viewId === 'metasView') loadMetasData();
                    if (viewId === 'ipsView') loadIPsData();
                    if (viewId === 'presidenciaView') {
                        loadPresidenciaMetasData();
                        loadProjetosData();
                    }
                    if (viewId === 'dashboardView') loadDashboardData();
                    if (viewId === 'relatoriosView') loadVPsForSelect(); // Apenas carrega o select, o relat√≥rio √© gerado ao selecionar
                });
            });
            
            // Sidebar mobile
            document.getElementById('openSidebar').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.add('active');
            });
            
            document.getElementById('closeSidebar').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.remove('active');
            });
            
            // Formul√°rios
            document.getElementById('vpForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const nome = document.getElementById('vpNome').value;
                const posicao = document.getElementById('vpPosicao').value;
                
                if (addVP(nome, posicao)) {
                    document.getElementById('vpForm').reset();
                    alert('VP adicionado com sucesso!');
                } else {
                    alert('Erro ao adicionar VP. Por favor, tente novamente.');
                }
            });
            
            document.getElementById('metaForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const descricao = document.getElementById('metaNome').value;
                const peso = parseInt(document.getElementById('metaPeso').value);
                
                if (addMeta(descricao, peso)) {
                    document.getElementById('metaForm').reset();
                    alert('Meta adicionada com sucesso!');
                } else {
                    alert('Erro ao adicionar meta. Por favor, tente novamente.');
                }
            });

            // Formul√°rio de adi√ß√£o de IP
            document.getElementById('ipForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const nome = document.getElementById('ipNome').value;
                const clube = document.getElementById('ipClube').value;
                
                if (addIP(nome, clube)) {
                    document.getElementById('ipForm').reset();
                    alert('Imagem P√∫blica adicionada com sucesso!');
                } else {
                    alert('Erro ao adicionar Imagem P√∫blica. Por favor, tente novamente.');
                }
            });
            
            document.getElementById('pontuacaoForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const targetId = document.getElementById('targetIdPontuacao').value;
                const targetType = document.getElementById('targetTypePontuacao').value;
                const metaId = document.getElementById('metaSelect').value;
                const pontuacao = parseInt(document.getElementById('pontuacaoValor').value);
                const pesoMaximo = parseInt(document.getElementById('pontuacaoMaxima').textContent);
                
                if (pontuacao > pesoMaximo) {
                    alert(`A pontua√ß√£o n√£o pode ser maior que ${pesoMaximo}.`);
                    return;
                }
                
                if (addPontuacao(targetType, targetId, metaId, pontuacao)) {
                    document.getElementById('pontuacaoModal').classList.add('hidden');
                    document.getElementById('pontuacaoForm').reset();
                } else {
                    alert('Erro ao adicionar pontua√ß√£o. Por favor, tente novamente.');
                }
            });

            // Formul√°rio de Projetos
            document.getElementById('projetoForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const id = document.getElementById('projetoForm').dataset.editId;
                const nome = document.getElementById('projetoNome').value;
                const dataInicio = document.getElementById('projetoDataInicio').value;
                const dataRealizacao = document.getElementById('projetoDataRealizacao').value;
                const objetivo = document.getElementById('projetoObjetivo').value;
                const beneficiarios = document.getElementById('projetoBeneficiarios').value;
                const areaEnfoque = document.getElementById('projetoAreaEnfoque').value;
                const dificuldades = document.getElementById('projetoDificuldades').value;

                if (id) {
                    if (updateProjeto(id, nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades)) {
                        alert('Projeto atualizado com sucesso!');
                    } else {
                        alert('Erro ao atualizar projeto.');
                    }
                    delete document.getElementById('projetoForm').dataset.editId; // Remove o ID de edi√ß√£o
                    document.querySelector('#projetoForm button[type="submit"]').textContent = 'Registrar Projeto'; // Volta o texto do bot√£o
                } else {
                    if (addProjeto(nome, dataInicio, dataRealizacao, objetivo, beneficiarios, areaEnfoque, dificuldades)) {
                        alert('Projeto registrado com sucesso!');
                    } else {
                        alert('Erro ao registrar projeto.');
                    }
                }
                document.getElementById('projetoForm').reset();
            });
            
            // Sele√ß√£o de pontua√ß√£o m√°xima
            document.getElementById('metaSelect').addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                document.getElementById('pontuacaoMaxima').textContent = selectedOption.dataset.max || '0';
            });
            
            // Fechar modais
            document.getElementById('closePontuacaoModal').addEventListener('click', function() {
                document.getElementById('pontuacaoModal').classList.add('hidden');
            });
            
            document.getElementById('cancelPontuacao').addEventListener('click', function() {
                document.getElementById('pontuacaoModal').classList.add('hidden');
            });
            
            document.getElementById('closeConfirmModal').addEventListener('click', function() {
                document.getElementById('confirmModal').classList.add('hidden');
            });
            
            document.getElementById('confirmCancel').addEventListener('click', function() {
                document.getElementById('confirmModal').classList.add('hidden');
            });
            
            // Selecionar VP para relat√≥rio
            document.getElementById('vpSelectRelatorio').addEventListener('change', updateRelatorio);
            
            // Clique fora do modal para fechar
            window.addEventListener('click', function(e) {
                if (e.target === document.getElementById('pontuacaoModal')) {
                    document.getElementById('pontuacaoModal').classList.add('hidden');
                }
                if (e.target === document.getElementById('confirmModal')) {
                    document.getElementById('confirmModal').classList.add('hidden');
                }
            });
        });
        
        // Fun√ß√µes globais para acesso dos bot√µes
        window.openPontuacaoModal = openPontuacaoModal;
        window.confirmDelete = confirmDelete;
        window.togglePresidenciaMeta = togglePresidenciaMeta;
        window.editProjeto = editProjeto;
    </script>
</body>
</html>
